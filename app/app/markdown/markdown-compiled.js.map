{"version":3,"sources":["markdown.js"],"names":[],"mappings":"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","file":"markdown-compiled.js","sourcesContent":["﻿import {asd} from './es6';\r\nimport TabEx from './tab-ex';\r\nimport ContextMenu from './component/contextmenu';\r\nimport storage from './component/storage';\r\n\r\n\r\nconst isInline = token => token && token.type === 'inline'\r\nconst isParagraph = token => token && token.type === 'paragraph_open'\r\nconst isListItem = token => token && token.type === 'list_item_open'\r\nconst startsWithTodoMarkdown = token => token && /^\\[( |x|X)\\]/.test(token.content)\r\n\r\nfunction isTodoItem(tokens, index) {\r\n    return isInline(tokens[index]) &&\r\n        isParagraph(tokens[index - 1]) &&\r\n        isListItem(tokens[index - 2]) &&\r\n        startsWithTodoMarkdown(tokens[index])\r\n}\r\n\r\nfunction setAttr(token, name, value) {\r\n    const index = token.attrIndex(name)\r\n    const attr = [name, value]\r\n\r\n    if (index < 0) {\r\n        token.attrPush(attr)\r\n    } else {\r\n        token.attrs[index] = attr\r\n    }\r\n}\r\n\r\nfunction parentToken(tokens, index) {\r\n    const targetLevel = tokens[index].level - 1\r\n    for (let i = index - 1; i >= 0; i--) {\r\n        if (tokens[i].level === targetLevel) {\r\n            return i\r\n        }\r\n    }\r\n    return -1\r\n}\r\n\r\nfunction todoify(token, TokenConstructor) {\r\n    token.children.unshift(createTodoItem(token, TokenConstructor))\r\n\r\n    const sliceIndex = '[ ]'.length\r\n    token.content = token.content.slice(sliceIndex)\r\n    token.children[1].content = token.children[1].content.slice(sliceIndex)\r\n}\r\n\r\nfunction createTodoItem(token, TokenConstructor) {\r\n    const todo = new TokenConstructor('html_inline', '', 0)\r\n    if (/^\\[ \\]/.test(token.content)) {\r\n        todo.content = '<input type=\"checkbox\">'\r\n    } else if (/^\\[(x|X)\\]/.test(token.content)) {\r\n        todo.content = '<input type=\"checkbox\" checked>'\r\n    }\r\n    return todo\r\n}\r\n\r\n// 文件管理器\r\nclass FileManager {\r\n    constructor() {\r\n        this.rootFile = 'F:\\\\Users\\\\cjh1\\\\Desktop\\\\note'; // 根目录\r\n        this.selectFile = null; // 选择的文件\r\n        this.curFile = null; // 当前正在编辑的文件\r\n    }\r\n\r\n    // 刷新\r\n    refresh () {\r\n        this.openFolder(this.rootFile);\r\n    }\r\n    \r\n    // 打开文件夹\r\n    openFolder(path) {\r\n        this.rootFile = path;\r\n        this.curFile = null;\r\n        system.loadFiles(path, function(err, results) {\r\n            if (err) {\r\n                throw err;\r\n            }\r\n\r\n            var zTreeObj;\r\n            // zTree 的参数配置，深入使用请参考 API 文档（setting 配置详解）\r\n            var setting = {\r\n                view: {\r\n                    /*showLine: false,*/\r\n                    dblClickExpand: false,\r\n                },\r\n                callback: {\r\n                    onClick: function (event, treeId, treeNode, clickFlag) {\r\n                        var ext = getExt(treeNode.file);\r\n                        var type = getType(treeNode.file);\r\n                        if (type === 'text') {\r\n                            if (!treeNode.children) {\r\n                                openFile(treeNode.file);\r\n                            }\r\n                        } else if (type === 'image') {\r\n                            system.openUri(treeNode.file);\r\n                        } else {\r\n                            ui.msg('暂不支持打开此类型的文件')\r\n                        }\r\n\r\n                    },\r\n                    onRightClick: function (e, treeId, treeNode) {\r\n                        if (!treeNode) {\r\n                            return false;\r\n                        }\r\n                        fm.selectFile = treeNode.file;\r\n                        ui.contextmenu($('#file-menu')[0], e.clientX, e.clientY);\r\n                        /*var ext = getExt(treeNode.file);\r\n                         var type = getType(treeNode.file);\r\n                         if (type === 'text') {\r\n                         if (treeNode.children) {\r\n                         fm.selectFile = treeNode.file;\r\n                         } else {\r\n                         openFile(treeNode.file);\r\n                         //$('#layout-file').hide();\r\n                         }\r\n                         } else if (type === 'image') {\r\n                         system.openUri(treeNode.file);\r\n                         } else {\r\n                         ui.msg('暂不支持打开此类型的文件')\r\n                         }*/\r\n                        return false;\r\n                    },\r\n                    beforeDrop: function(treeId, treeNodes, targetNode, moveType) {\r\n                        return targetNode ? targetNode.drop !== false : true;\r\n                    },\r\n                    onDrop: function(event, treeId, treeNodes, targetNode, moveType, isCopy) {\r\n                        if (targetNode) {\r\n                            treeNodes.forEach(function (node) {\r\n                                var fileName = getNameFromPath(node.file);\r\n                                var newName = targetNode.file + '\\\\' + fileName ;\r\n                                system.rename(node.file, newName);\r\n                                node.file = newName;\r\n                            });\r\n\r\n                        }\r\n                    }\r\n                },\r\n                edit: {\r\n                    enable: true,\r\n                    showRemoveBtn: false,\r\n                    showRenameBtn: false,\r\n                    drag: {\r\n                        isMove: true\r\n                    }\r\n                }\r\n\r\n\r\n            };\r\n            // zTree 的数据属性，深入使用请参考 API 文档（zTreeNode 节点数据详解）\r\n            var zNodes = [\r\n                {\r\n                    id: '1212',\r\n                    name:\"test1\",\r\n                    open:true,\r\n                    children:[\r\n                        {name:\"test1_1\"}, {name:\"test1_2\"}\r\n                    ]\r\n                },\r\n                {\r\n                    id: '1aaa',\r\n                    name:\"test2\",\r\n                    open:true,\r\n                    children: [\r\n                        {\r\n                            name:\"test2_1\"}, {name:\"test2_2\"}]}\r\n            ];\r\n            zTreeObj = $.fn.zTree.init($(\"#treeDemo\"), setting, results);\r\n        });\r\n    }\r\n\r\n}\r\n\r\nvar system = System.getInstance();\r\n\r\nvar preview = document.getElementById(\"preview\");\r\n\r\nvar editor = CodeMirror.fromTextArea(document.getElementById(\"text-input\"), {\r\n    //theme: 'emd',\r\n    mode: 'gfm',\r\n    selectionPointer: true,\r\n    //lineNumbers: true,\r\n    matchBrackets: true,\r\n    indentUnit: 4,\r\n    indentWithTabs: true,\r\n    onChange: function () {\r\n\r\n    }\r\n});\r\n\r\nlet fm = new FileManager();\r\nfm.openFolder(fm.rootFile);\r\nopenFile(fm.rootFile + '\\\\readme.md');\r\n\r\n\r\n\r\nArray.prototype.contains = Array.prototype.contains || function(obj) {\r\n    var i = this.length;\r\n    while (i--) {\r\n        if (this[i] === obj) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n};\r\n\r\nString.prototype.contains = String.prototype.contains || function (str) {\r\n    return this.indexOf(str) >= 0;\r\n};\r\n\r\n;(function () {\r\n    function MdEditor(option) {\r\n        var that = this;\r\n        this.opts = $.extend({}, MdEditor.DEFAULTS, option);\r\n\r\n        // 五分钟自动保存一次\r\n        if (that.opts.autoSave) {\r\n            setInterval(function () {\r\n                save();\r\n            }, 5 * 60 * 1000);\r\n        }\r\n    }\r\n\r\n    MdEditor.DEFAULTS = {\r\n        autoSave: false\r\n    };\r\n\r\n    window.MdEditor = MdEditor;\r\n})();\r\n\r\n\r\nvar mdeditor = new MdEditor({\r\n    autoSave: true\r\n});\r\n\r\n$(document).contextmenu({\r\n    content: '#global-menu'\r\n});\r\n$('#layout-preview').contextmenu({\r\n    item: 'img',\r\n    content: '#image-menu'\r\n});\r\n$('#layout-file').contextmenu({\r\n    content: '#files-menu'\r\n});\r\n\r\n$('#global-menu-about').on('click', function () {\r\n    ui.alert('markdown编辑器 v2016.11.26');\r\n});\r\n$('#global-menu-help').on('click', function () {\r\n    ui.frame('help.html', {\r\n        title: '帮助'\r\n    });\r\n});\r\n$('#global-menu-close-preview').on('click', function () {\r\n    $('#layout-preview').hide();\r\n});\r\n\r\n\r\n\r\neditor.setOption('lineWrapping', true);\r\n\r\nfunction setEditorTheme(theme) {\r\n    editor.setOption(\"theme\", theme);\r\n    if (!$('#style-' + theme).length) {\r\n        $('head').append($('<link id=\"style-' + theme + '\" rel=\"stylesheet\" href=\"asset/lib/codemirror/theme/' + theme + '.css\">'));\r\n    }\r\n}\r\nsetEditorTheme('emd')\r\n\r\n$('#theme-select').on('change', function () {\r\n    var theme = this.options[this.selectedIndex].text;\r\n    setEditorTheme(theme);\r\n});\r\n\r\n\r\neditor.on(\"change\", function (cm, event) {\r\n    var text = editor.getValue();\r\n    var md = window.markdownit();\r\n    md.core.ruler.after('inline', 'evernote-todo', state => {\r\n        const tokens = state.tokens\r\n        for (let i = 0; i < tokens.length; i++) {\r\n            if (isTodoItem(tokens, i)) {\r\n                todoify(tokens[i], state.Token)\r\n                setAttr(tokens[i - 2], 'class', 'task-list-item')\r\n                setAttr(tokens[parentToken(tokens, i - 2)], 'class', 'task-list')\r\n            }\r\n        }\r\n    })\r\n    //md.use(require('markdown-it-enml-todo'))\r\n    preview.innerHTML = md.render(text);\r\n    \r\n    // 字数统计\r\n    var p = $('#preview').find('p').length;\r\n    $('#status').text(text.replace(/\\s/g, '').length + '字符, ' + p + '段落');\r\n});\r\n\r\neditor.on(\"scroll\", function (cm, event) {\r\n    var info = cm.getScrollInfo();\r\n    var percent = info.top / (info.height - info.clientHeight);\r\n    var scrollTop = ($('#layout-preview')[0].scrollHeight - $('#layout-preview')[0].clientHeight) * percent;\r\n    $('#layout-preview').scrollTop(scrollTop);\r\n\r\n});\r\n\r\n$('#layout-preview').on('scroll', function () {\r\n    var range = this.scrollHeight - this.clientHeight;\r\n});\r\n\r\nfunction blobToFile(theBlob, fileName){\r\n    //A Blob() is almost a File() - it's just missing the two properties below which we will add\r\n    theBlob.lastModifiedDate = new Date();\r\n    theBlob.name = fileName;\r\n    return theBlob;\r\n}\r\neditor.on(\"paste\", function (cm, e) {\r\n    var clipboard = e.clipboardData;\r\n    var text, textType = 'text/plain';\r\n    if (clipboard) { // w3c(webkit,opera...)\r\n        if (clipboard.types && clipboard.types.contains(textType)) {\r\n            //e.preventDefault();\r\n            text = clipboard.getData(textType);\r\n            //this.replaceText(range, text)\r\n        }\r\n\r\n        if ( e.clipboardData.items ) {\r\n            // google-chrome\r\n            var ele = e.clipboardData.items\r\n            for (var i = 0; i < ele.length; ++i) {\r\n                if ( ele[i].kind == 'file' && ele[i].type.indexOf('image/') !== -1 ) {\r\n\r\n                    var blob = ele[i].getAsFile();\r\n\r\n                    window.URL = window.URL || window.webkitURL;\r\n                    var blobUrl = window.URL.createObjectURL(blob);\r\n\r\n                    var imagePath = fm.rootFile + '\\\\data\\\\img\\\\123.jpg';\r\n                    var buf = new Buffer(blob, 'base64'); // decode\r\n                    /*fs.writeFile(imagePath, blob, function(err) {\r\n\r\n                    })*/\r\n\r\n                    /*fs.writeFile(imagePath, blob, \"binary\", function(err){\r\n                        if(err){\r\n                        }\r\n                    });*/\r\n\r\n\r\n                }\r\n            }\r\n        } else {\r\n            alert('non-chrome');\r\n        }\r\n    }\r\n\r\n    return true;\r\n});\r\n\r\n\r\nfunction createDir() {\r\n    //是否显示导航栏\r\n    var showNavBar = true;\r\n    //是否展开导航栏\r\n    var expandNavBar = true;\r\n\r\n    var h1s = $(\"#preview\").find(\"h1\");\r\n    var h2s = $(\"#preview\").find(\"h2\");\r\n    var h3s = $(\"#preview\").find(\"h3\");\r\n    var h4s = $(\"#preview\").find(\"h4\");\r\n    var h5s = $(\"#preview\").find(\"h5\");\r\n    var h6s = $(\"#preview\").find(\"h6\");\r\n\r\n    var headCounts = [h1s.length, h2s.length, h3s.length, h4s.length, h5s.length, h6s.length];\r\n    var vH1Tag = null;\r\n    var vH2Tag = null;\r\n    for(var i = 0; i < headCounts.length; i++){\r\n        if(headCounts[i] > 0){\r\n            if(vH1Tag == null){\r\n                vH1Tag = 'h' + (i + 1);\r\n            }else{\r\n                vH2Tag = 'h' + (i + 1);\r\n            }\r\n        }\r\n    }\r\n    if(vH1Tag == null){\r\n        return;\r\n    }\r\n\r\n    $(\"#toc\").append('<div class=\"BlogAnchor\">' +\r\n        '<span style=\"color:red;position:absolute;top:-6px;left:0px;cursor:pointer;\" onclick=\"$(\\'.BlogAnchor\\').hide();\">×</span>' +\r\n        '<p>' +\r\n        '<b id=\"AnchorContentToggle\" title=\"收起\" style=\"cursor:pointer;\">目录▲</b>' +\r\n        '</p>' +\r\n        '<div class=\"AnchorContent\" id=\"AnchorContent\"> </div>' +\r\n        '</div>' );\r\n\r\n    var vH1Index = 0;\r\n    var vH2Index = 0;\r\n    $(\"#preview\").find(\"h1,h2,h3,h4,h5,h6\").each(function(i,item){\r\n        var id = '';\r\n        var name = '';\r\n        var tag = $(item).get(0).tagName.toLowerCase();\r\n        var className = '';\r\n        if(tag == vH1Tag){\r\n            id = name = ++vH1Index;\r\n            name = id;\r\n            vH2Index = 0;\r\n            className = 'item_h1';\r\n        }else if(tag == vH2Tag){\r\n            id = vH1Index + '_' + ++vH2Index;\r\n            name = vH1Index + '.' + vH2Index;\r\n            className = 'item_h2';\r\n        }\r\n        $(item).attr(\"id\",\"wow\"+id);\r\n        $(item).addClass(\"wow_head\");\r\n        $(\"#AnchorContent\").css('max-height', ($(window).height() - 180) + 'px');\r\n        $(\"#AnchorContent\").append('<li><a class=\"nav_item '+className+' anchor-link\" onclick=\"return false;\" href=\"#\" link=\"#wow'+id+'\">'+name+\" · \"+$(this).text()+'</a></li>');\r\n    });\r\n\r\n    $(\"#AnchorContentToggle\").click(function(){\r\n        var text = $(this).html();\r\n        if(text==\"目录▲\"){\r\n            $(this).html(\"目录▼\");\r\n            $(this).attr({\"title\":\"展开\"});\r\n        }else{\r\n            $(this).html(\"目录▲\");\r\n            $(this).attr({\"title\":\"收起\"});\r\n        }\r\n        $(\"#AnchorContent\").toggle();\r\n    });\r\n    $(\".anchor-link\").click(function(){\r\n        $(\"html,body\").animate({scrollTop: $($(this).attr(\"link\")).offset().top}, 500);\r\n    });\r\n\r\n    var headerNavs = $(\".BlogAnchor li .nav_item\");\r\n    var headerTops = [];\r\n    $(\".wow_head\").each(function(i, n){\r\n        headerTops.push($(n).offset().top);\r\n    });\r\n    $(window).scroll(function(){\r\n        var scrollTop = $(window).scrollTop();\r\n        $.each(headerTops, function(i, n){\r\n            var distance = n - scrollTop;\r\n            if(distance >= 0){\r\n                $(\".BlogAnchor li .nav_item.current\").removeClass('current');\r\n                $(headerNavs[i]).addClass('current');\r\n                return false;\r\n            }\r\n        });\r\n    });\r\n\r\n    if(!showNavBar){\r\n        $('.BlogAnchor').hide();\r\n    }\r\n    if(!expandNavBar){\r\n        $(this).html(\"目录▼\");\r\n        $(this).attr({\"title\":\"展开\"});\r\n        $(\"#AnchorContent\").hide();\r\n    }\r\n}\r\n\r\nfunction openFile(path) {\r\n    fm.curFile = path;\r\n    system.readFile(path, function(err, data) {\r\n        editor.setValue(data);\r\n    });\r\n    \r\n    \r\n    var html = editor.getValue();\r\n    preview.innerHTML = markdown.toHTML(html);\r\n    createDir();\r\n}\r\n\r\n\r\n\r\n\r\n\r\nvar btn = document.getElementById('open-file');\r\n\r\nfunction openFolder() {\r\n    system.selectDir(function (path) {\r\n        if (path) {\r\n            fm.openFolder(path);\r\n        }\r\n    });\r\n}\r\n\r\n$(document).on('keydown', function (e) {\r\n    if (e.ctrlKey) {\r\n\r\n        switch (e.keyCode) {\r\n            case 66: // b\r\n                editor.replaceSelection('**' + editor.getSelection() + '**');\r\n                return false;\r\n            case 73: // i\r\n                editor.replaceSelection('*' + editor.getSelection() + '*');\r\n                return false;\r\n            case 82: // r\r\n                window.location.reload(true);\r\n                return false;\r\n            case 83: // s\r\n                save();\r\n                return false;\r\n            case 191: // /\r\n                help();\r\n                return false;\r\n        }\r\n\r\n    }\r\n});\r\n\r\n\r\nvar holder = document.getElementById('layout-editor');\r\nholder.ondragover = function () {\r\n    return false;\r\n};\r\nholder.ondragleave = holder.ondragend = function () {\r\n    return false;\r\n};\r\n\r\nfunction getExt(filename) {\r\n    return filename.toLowerCase().substr(filename.lastIndexOf(\".\") + 1);\r\n}\r\nfunction getNameFromPath(filename) {\r\n    return filename.substr(filename.lastIndexOf('\\\\')+1);\r\n}\r\n\r\nfunction getType(filename) {\r\n    var ext = getExt(filename);\r\n    if (!ext) {\r\n        return null;\r\n    }\r\n    if ('txt|css|md'.contains(ext)) {\r\n        return 'text';\r\n    } else if ('png|jpg|gif'.contains(ext)) {\r\n        return 'image'\r\n    } else if ('mp4'.contains(ext)) {\r\n        return 'video';\r\n    } else if ('mp3'.contains(ext)) {\r\n        return 'audio';\r\n    }\r\n\r\n    return 'text'; // TODO\r\n    //text/plain\r\n    //text/html\r\n    //application\r\n}\r\n\r\nholder.ondrop = function (e) {\r\n    e.preventDefault();\r\n    var file = e.dataTransfer.files[0];\r\n    if (/image*/.test(file.type)) {\r\n        var imagePath = fm.rootFile + '\\\\data\\\\img';\r\n        fs.exists(imagePath, function(exists) {\r\n            if (!exists) {\r\n                fs.mkdirSync(imagePath, 777);\r\n            }\r\n\r\n            var newImageFile = imagePath + '\\\\' + new Date().getTime() + '.' + getExt(file.path);\r\n            fs.writeFileSync(newImageFile, fs.readFileSync(file.path));\r\n\r\n            editor.replaceSelection('![](' + newImageFile + ')');\r\n        });\r\n    } else {\r\n        fs.stat(file.path, function(err, stat) {\r\n            if (stat && stat.isDirectory()) {\r\n                fm.openFolder(file.path);\r\n            } else {\r\n                openFile(file.path);\r\n            }\r\n        });\r\n    }\r\n    //openFile(file.path);\r\n    return false;\r\n};\r\n$('#show-files').on('click', function (e) {\r\n    e.preventDefault();\r\n    $('#layout-file').show();\r\n});\r\n\r\n$('#global-menu-toggle').on('click', function (e) {\r\n    e.preventDefault();\r\n    if ($('#layout-file').is(':hidden')) {\r\n        $('#layout-file').show();\r\n        $('#layout-editor').css({\r\n            'width': '40%',\r\n            'left': '20%'\r\n        });\r\n        $('#layout-preview').css('width', '40%');\r\n    } else {\r\n        $('#layout-file').hide();\r\n        $('#layout-editor').css({\r\n            'width': '50%',\r\n            'left': '0'\r\n        });\r\n        $('#layout-preview').css('width', '50%');\r\n    }\r\n\r\n});\r\n\r\n$('#files-refresh').on('click', function (e) {\r\n    e.preventDefault();\r\n    fm.openFolder(fm.rootFile);\r\n});\r\n\r\nfunction save() {\r\n    if (fm.curFile) {\r\n        system.writeFile(fm.curFile, editor.getValue(), function () {\r\n            ui.msg('保存成功');\r\n        });\r\n    }\r\n}\r\n$('#save').on('click', function (e) {\r\n    e.preventDefault();\r\n    save();\r\n});\r\n$('#remove-file').on('click', function () {\r\n    let fileName = getNameFromPath(fm.selectFile);\r\n    ui.confirm('删除  ' + fileName, function (index) {\r\n        ui.close(index);\r\n        system.removeFile(fm.selectFile, function () {\r\n            fm.refresh();\r\n        });\r\n    });\r\n});\r\n$('#remame').on('click', function () {\r\n    var fileName = getNameFromPath(fm.selectFile);\r\n    ui.prompt({\r\n        title: '新的名称',\r\n        value: fileName\r\n    }, function (name, index) {\r\n        if (!name) {\r\n            ui.msg('请输入文件名');\r\n            return;\r\n        }\r\n        ui.close(index);\r\n        system.rename(fm.selectFile, fm.selectFile.replace(fileName, name));\r\n        fm.refresh();\r\n    })\r\n});\r\n$('#add-file').on('click', function () {\r\n    ui.prompt({\r\n        title: '文件名',\r\n    }, function (name, index) {\r\n        if (!name) {\r\n            ui.msg('请输入文件名');\r\n            return;\r\n        }\r\n        ui.close(index);\r\n        system.writeFile(fm.selectFile + '\\\\' + name, '', function () {\r\n            ui.msg('添加成功');\r\n            fm.openFolder(fm.rootFile);\r\n        });\r\n    })\r\n});\r\n$('#add-folder').on('click', function () {\r\n    ui.prompt({\r\n        title: '文件夹名',\r\n    }, function (name, index) {\r\n        if (!name) {\r\n            ui.msg('请输入文件夹名');\r\n            return;\r\n        }\r\n        ui.close(index);\r\n        system.mkdir(fm.selectFile + '\\\\' + name, function () {\r\n            ui.msg('添加成功');\r\n            fm.openFolder(fm.rootFile);\r\n        });\r\n    })\r\n});\r\n\r\n\r\n\r\n\r\n\r\nfunction help() {\r\n    ui.frame('help.html', {\r\n        title: '帮助'\r\n    });\r\n}\r\n\r\nvar    textarea = document.getElementsByTagName('textarea')[0],\r\n    read_btn = document.getElementById('read_btn'),\r\n    write_btn = document.getElementById('write_btn');\r\n\r\n$('#preview').on('click', 'a', function (e) {\r\n    e.preventDefault();\r\n    system.openUri(this.href);\r\n});\r\n\r\nvar trayMenuTemplate = [\r\n    {\r\n        label: '文件',\r\n        //enabled: false\r\n        submenu: [\r\n            {\r\n                label: '新建',\r\n                click: function () {\r\n                    fm.curFile = null;\r\n                    editor.setValue(''); // TODO\r\n                }\r\n            },\r\n            {\r\n                label: '打开文件',\r\n                click: function () {\r\n                    system.fm.selectFile(function (uri) {\r\n                        if (uri) {\r\n                            openFile(uri);\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n            {\r\n                label: '打开文件夹',\r\n                click: function () {\r\n                    openFolder();\r\n                }\r\n            },\r\n            {\r\n                label: '保存',\r\n                click: function () {\r\n                    save();\r\n                    if (!fm.curFile) {\r\n\r\n                    }\r\n                }\r\n            },\r\n            {\r\n                label: '另存为',\r\n                click: function () {\r\n                    ui.msg('暂不支持');\r\n                }\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        label: '更多',\r\n        submenu: [\r\n            {\r\n                label: '设置',\r\n                click: function () {\r\n                    ui.frame('setting.html', {\r\n                        title: '关于'\r\n                    });\r\n                }\r\n            },\r\n            {\r\n                label: 'html转markdown',\r\n                click: function () {\r\n                    window.open('html2md.html');\r\n                }\r\n            },\r\n            {\r\n                label: '导出为网页',\r\n                click: function () {\r\n\r\n                }\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        label: '工具',\r\n        submenu: [\r\n            {\r\n                label: '生成文档',\r\n                click: function () {\r\n                    system.selectDir(function (path) {\r\n                        system.createDoc(path);\r\n                    });\r\n                }\r\n            }\r\n        ]\r\n    },\r\n    {\r\n        label: '帮助',\r\n        submenu: [\r\n            {\r\n                label: '查看帮助',\r\n                click: function () {\r\n                    help();\r\n                }\r\n            },\r\n            {\r\n                label: '关于',\r\n                //accelerator: 'CmdOrCtrl+M',\r\n                //role: 'reload', minimize minimize\r\n                click: function () {\r\n                    ui.frame('about.html', {\r\n                        title: '关于'\r\n                    });\r\n                }\r\n            },\r\n        ]\r\n    }\r\n];\r\n\r\nvar menuevent = {};\r\nfunction showMenu(menu) {\r\n    var html = '';\r\n    for (var i = 0; i < menu.length; i++) {\r\n        var item = menu[i];\r\n\r\n        html += '<li class=\"nav-item dropdown dropdown-hover\">' +\r\n            '<a class=\"nav-link dropdown-toggle\" href=\"#\" data-toggle=\"dropdown\" data-id=\"' + i + '-0\">' +\r\n            item.label + '<i class=\"caret\"></i>' +\r\n            '</a>' +\r\n            (function () {\r\n                if (item.submenu) {\r\n                    var submenu = '<ul class=\"dropdown-menu\">';\r\n                    for (var j = 0; j < item.submenu.length; j++) {\r\n                        submenu += '<li><a data-id=\"' + i + (j + 1)+ '\" href=\"#\">' + item.submenu[j].label + '</a></li>';\r\n                        if (item.submenu[j].click) {\r\n                            menuevent[i + '' + (j + 1)] = item.submenu[j].click;\r\n                        }\r\n                    }\r\n                    submenu += '</ul>';\r\n                    return submenu;\r\n\r\n                } else {\r\n                    return '';\r\n                }\r\n\r\n            })() + '</li>';\r\n        if (item.click) {\r\n            menuevent[i + '0'] = click;\r\n        }\r\n    }\r\n    $('#menu-layoutit')[0].innerHTML = html;\r\n    $('#menu-layoutit').on('click', 'a', function () {\r\n        var id = $(this).data('id');\r\n        if (menuevent[id]) {\r\n            menuevent[id]();\r\n        }\r\n    })\r\n}\r\n\r\nshowMenu(trayMenuTemplate);\r\n\r\nvar tab = new TabEx('#tabs', {\r\n    //monitor: '.topbar'\r\n});\r\n\r\n//$('#tabs').addtabs({});\r\n\r\nvar iddd = 123;\r\nfunction getIdd() {\r\n    return iddd++;\r\n}\r\n\r\nvar id = getIdd();\r\n/*tab.add({\r\n    id: $(this).attr('addtabs'),\r\n    title: '标题',\r\n    content: '<textarea id=\"' + id + '\"></textarea>',\r\n})\r\nvar editor = CodeMirror.fromTextArea(document.getElementById(id), {\r\n    //theme: 'emd',\r\n    mode: 'gfm',\r\n    selectionPointer: true,\r\n    //lineNumbers: true,\r\n    matchBrackets: true,\r\n    indentUnit: 4,\r\n    indentWithTabs: true,\r\n    onChange: function () {\r\n\r\n    }\r\n});\r\n */"]}