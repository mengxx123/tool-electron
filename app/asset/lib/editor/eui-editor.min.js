/*! eui-editor.js 2016-11-25 */
!function(a){"function"==typeof window.define?window.define.amd?window.define("eEditor",["jquery"],a):window.define.cmd?window.define(function(b,c,d){return a}):a(window.jQuery):"object"==typeof module&&"object"==typeof module.exports?(window.eEditorCssPath?require(window.eEditorCssPath):require("../dist/css/eEditor.css"),module.exports=a(window.eEditorJQueryPath?require(window.eEditorJQueryPath):require("jquery"))):a(window.jQuery)}(function(a){if(!jQuery)return void alert("在引用 editor.js 之前，先引用jQuery，否则无法使用 editor");var b=function(b){var c=window.EDITOR;c&&b(c,a)};return function(a,b){if(a.EDITOR)return void alert("一个页面不能重复引用 editor.js ！！！");var c=function(a,d){"string"==typeof a&&(a="#"+a);var e=b(a);if(1===e.length){this.opts=b.extend({},c.DEFAULTS,d);var f=e[0].nodeName;"TEXTAREA"!==f&&"DIV"!==f||(this.lock=!1,this.valueNodeName=f.toLowerCase(),this.$valueContainer=e,this.$prev=e.prev(),this.$parent=e.parent(),this.init())}};c.DEFAULTS={simple:!1},c.fn=c.prototype,c.$body=b("body"),c.$document=b(document),c.$window=b(a),c.userAgent=navigator.userAgent,c.getComputedStyle=a.getComputedStyle,c.w3cRange="function"==typeof document.createRange,c.hostname=location.hostname.toLowerCase(),c.websiteHost="eeditor.github.io|www.eeditor.com|eeditor.coding.me",c.isOnWebsite=c.websiteHost.indexOf(c.hostname)>=0,c.isOnWebsite=!0,a.Editor=a.EDITOR=c,c.plugin=function(a){c._plugins||(c._plugins=[]),"function"==typeof a&&c._plugins.push(a)}}(window,a),b(function(a,b){a.fn.addEditorContainer=function(){this.$editorContainer=b('<div class="eEditor-container"></div>')},a.fn.addTxt=function(){var b=this,c=new a.Txt(b);b.txt=c},a.fn.initDefaultConfig0=function(){var c=this;c.config=b.extend({},a.config)},a.fn.init=function(){this.readyFns=[],this.initDefaultConfig0(),this.initDefaultConfig&&this.initDefaultConfig(),this.opts.simple||this.addEditorContainer&&this.addEditorContainer(),this.addTxt&&this.addTxt(),this.readyHeadler(),a.readyHeadler.call(this),this.commandHooks(),this.initUi&&this.initUi()},a.fn.triggerChange=function(){this.lock||this.trigger("stateChange")}}),b(function(a,b){a.fn.ready=function(a){!this.readyFns,this.readyFns.push(a)},a.fn.readyHeadler=function(){for(var a=this.readyFns;a.length;)a.shift().call(this)},a.fn.updateValue=function(){var a=this,b=a.txt.$txt;if(a.$valueContainer!==b){var c=b.html();a.$valueContainer.val(c)}},a.fn.getInitValue=function(){var a=this,b="",c=a.valueNodeName;return"div"===c?b=a.$valueContainer.html():"textarea"===c&&(b=a.$valueContainer.val()),b}}),b(function(a,b){function c(){}var d=!a.w3cRange;a.fn.test=function(){},a.fn.currentRange=function(a){return a?void(this._rangeData=a):this._rangeData},a.fn.collapseRange=function(a,b){b=b||"end",b="start"===b,a=a||this.currentRange(),a&&(a.collapse(b),this.currentRange(a))},a.fn.getRangeText=d?c:function(a){if(a=a||this.currentRange())return a.toString()},a.fn.getRangeElem=d?c:function(a){a=a||this.currentRange();var b=a.commonAncestorContainer;return 1===b.nodeType?b:b.parentNode},a.fn.isRangeEmpty=d?c:function(a){return a=a||this.currentRange(),!(!a||!a.startContainer||a.startContainer!==a.endContainer||a.startOffset!==a.endOffset)},a.fn.saveSelection=d?c:function(a){var c,d,e=this,f=e.txt.$txt.get(0);a?c=a.commonAncestorContainer:(d=document.getSelection(),d.getRangeAt&&d.rangeCount&&(a=document.getSelection().getRangeAt(0),c=a.commonAncestorContainer)),c&&(b.contains(f,c)||f===c)&&e.currentRange(a)},a.fn.restoreSelection=d?c:function(b){var c;if(b=b||this.currentRange())try{c=document.getSelection(),c.removeAllRanges(),c.addRange(b)}catch(d){a.error("执行 editor.restoreSelection 时，IE可能会有异常，不影响使用")}},a.fn.restoreSelectionByElem=d?c:function(a,b){a&&(b=b||"end",this.setRangeByElem(a),"start"===b&&this.collapseRange(this.currentRange(),"start"),"end"===b&&this.collapseRange(this.currentRange(),"end"),this.restoreSelection())},a.fn.initSelection=d?c:function(){var a=this;if(!a.currentRange()){var b=a.txt.$txt,c=b.children().first();c.length&&a.restoreSelectionByElem(c.get(0))}},a.fn.setRangeByElem=d?c:function(a){var c=this,d=c.txt.$txt.get(0);if(a&&b.contains(d,a)){for(var e=a.firstChild;e&&3!==e.nodeType;)e=e.firstChild;for(var f=a.lastChild;f&&3!==f.nodeType;)f=f.lastChild;var g=document.createRange();e&&f?(g.setStart(e,0),g.setEnd(f,f.textContent.length)):(g.setStart(a,0),g.setEnd(a,0)),c.saveSelection(g)}}}),b(function(a,b){a.fn.commandHooks=function(){var a=this,c={};c.insertHtml=function(c){var d,e=b(c),f=a.getRangeElem();d=a.getLegalTags(f),d&&b(d).after(e)},a.commandHooks=c}}),b(function(a,b){a.fn.command=function(a,b,c,d){function e(){b&&(g.queryCommandSupported(b)?document.execCommand(b,!1,c):(f=g.commandHooks,b in f&&f[b](c)))}var f,g=this;this.customCommand(a,e,d)},a.fn.commandForElem=function(a,b,c,d,e){var f,g;"string"==typeof a?f=a:(f=a.selector,g=a.check);var h=this.getRangeElem();h=this.getSelfOrParentByName(h,f,g),h&&this.setRangeByElem(h),this.command(b,c,d,e)},a.fn.customCommand=function(a,b,c){var d=this,e=d.currentRange();return e?(d.undoRecord&&d.undoRecord(),this.restoreSelection(e),b.call(d),this.saveSelection(),this.restoreSelection(),c&&"function"==typeof c&&c.call(d),d.txt.insertEmptyP(),d.txt.wrapImgAndText(),d.updateValue(),d.updateMenuStyle&&d.updateMenuStyle(),d.triggerChange(),void(a&&a.preventDefault())):void(a&&a.preventDefault())},a.fn.queryCommandState=function(b){if(a.cmds[b]&&a.cmds[b].queryState){var c=a.cmds[b].queryState(this);return c}var d=b;a.cmds[b]&&a.cmds[b].systemCmd&&(d=a.cmds[b].systemCmd);var c=!1;try{c=document.queryCommandState(d)}catch(e){}return c},a.fn.queryCommandSupported=function(a){var b=!1;try{b=document.queryCommandSupported(a)}catch(c){}return b}}),b(function(a,b){function c(a){var c=this,d=b(a),e=!1;return d.each(function(){if(this===c)return e=!0,!1}),e}var d;a.fn.getLegalTags=function(b){var c=this.config.legalTags;return c?this.getSelfOrParentByName(b,c):void a.error("配置项中缺少 legalTags 的配置")},a.fn.getSelfOrParentByName=function(a,e,f){if(a&&e){d||(d=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector),d||(d=c);for(var g=this.txt.$txt.get(0);a&&g!==a&&b.contains(g,a);){if(d.call(a,e)){if(!f)return a;if(f(a))return a}a=a.parentNode}}}}),b(function(a,b){var c=window.console,d=function(){};b.each(["info","log","warn","error"],function(b,e){null==c?a[e]=d:a[e]=function(b){a.config&&a.config.printLog&&c[e]("editor提示: "+b)}}),a.random=function(){return Math.random().toString().slice(2)}}),b(function(a,b){a.langs={},a.langs["zh-cn"]={bold:"粗体",underline:"下划线",italic:"斜体",forecolor:"文字颜色",bgcolor:"背景色",strikethrough:"删除线",eraser:"清空格式",source:"源码",quote:"引用",fontfamily:"字体",fontsize:"字号",head:"标题",orderlist:"有序列表",unorderlist:"无序列表",alignleft:"左对齐",aligncenter:"居中",alignright:"右对齐",link:"链接",text:"文本",submit:"提交",cancel:"取消",unlink:"取消链接",table:"表格",emotion:"表情",img:"图片",video:"视频",width:"宽",height:"高",location:"位置",loading:"加载中",searchlocation:"搜索位置",dynamicMap:"动态地图",clearLocation:"清除位置",langDynamicOneLocation:"动态地图只能显示一个位置",insertcode:"插入代码",undo:"撤销",redo:"重复",fullscreen:"全屏",openLink:"打开链接"},a.langs.en={bold:"Bold",underline:"Underline",italic:"Italic",forecolor:"Color",bgcolor:"Backcolor",strikethrough:"Strikethrough",eraser:"Eraser",source:"Codeview",quote:"Quote",fontfamily:"Font family",fontsize:"Font size",head:"Head",orderlist:"Ordered list",unorderlist:"Unordered list",alignleft:"Align left",aligncenter:"Align center",alignright:"Align right",link:"Insert link",text:"Text",submit:"Submit",cancel:"Cancel",unlink:"Unlink",table:"Table",emotion:"Emotions",img:"Image",video:"Video",width:"width",height:"height",location:"Location",loading:"Loading",searchlocation:"search",dynamicMap:"Dynamic",clearLocation:"Clear",langDynamicOneLocation:"Only one location in dynamic map",insertcode:"Insert Code",undo:"Undo",redo:"Redo",fullscreen:"Full screnn",openLink:"open link"}}),b(function(a,b){a.config={},a.config.zindex=1e4,a.config.printLog=!0,a.config.jsFilter=!0,a.config.legalTags="p,h1,h2,h3,h4,h5,h6,blockquote,table,ul,ol,pre",a.config.lang=a.langs["zh-cn"],a.config.pasteFilter=!0,a.config.pasteText=!1}),b(function(a,b){var c=function(a){this.editor=a,this.init()};c.fn=c.prototype,a.Txt=c}),b(function(a,b){var c=a.Txt;c.fn.init=function(){var a,c=this,d=c.editor,e=d.$valueContainer,f=d.getInitValue();"DIV"===e.get(0).nodeName?(a=e,a.addClass("eEditor-txt"),a.attr("contentEditable","true"),console.log("是")):(console.log("不是"),a=b('<div class="eEditor-txt" contentEditable="true">'+f+"</div>")),d.ready(function(){c.insertEmptyP()}),c.$txt=a,c.contentEmptyHandle(),c.bindEnterForDiv(),c.bindEnterForText(),c.bindTabEvent(),c.bindPasteFilter(),c.bindFormatText(),c.bindHtml()},c.fn.contentEmptyHandle=function(){var a,c=this,d=c.editor,e=c.$txt;e.on("keydown.ui.editor",function(a){if(8===a.keyCode){var c=b.trim(e.html().toLowerCase());return"<p><br></p>"===c?void a.preventDefault():void 0}}),e.on("keyup.ui.editor",function(c){if(8===c.keyCode){var f=b.trim(e.html().toLowerCase());f&&"<br>"!==f||(a=b("<p><br/></p>"),e.html(""),e.append(a),d.restoreSelectionByElem(a.get(0)))}})},c.fn.bindEnterForDiv=function(){function c(){if(d){var a=b("<p>"+d.html()+"</p>");d.after(a),d.remove()}}var d,e=(a.config.legalTags,this),f=e.editor,g=e.$txt;g.on("keydown.ui.editor keyup.ui.editor",function(a){if(13===a.keyCode){var e,g,h=f.getRangeElem(),i=f.getLegalTags(h);if(!i){if(i=f.getSelfOrParentByName(h,"div"),!i)return;e=b(i),"keydown"===a.type&&(d=e,setTimeout(c,0)),"keyup"===a.type&&(g=b("<p>"+e.html()+"</p>"),e.after(g),e.remove(),f.restoreSelectionByElem(g.get(0),"start"))}}})},c.fn.bindEnterForText=function(){var a,b=this,c=b.$txt;c.on("keyup.ui.editor",function(c){13===c.keyCode&&(a||(a=function(){b.wrapImgAndText()}),setTimeout(a))})},c.fn.bindTabEvent=function(){var a=this,b=a.editor,c=a.$txt;c.on("keydown.ui.editor",function(a){9===a.keyCode&&b.queryCommandSupported("insertHtml")&&b.command(a,"insertHtml","&nbsp;&nbsp;&nbsp;&nbsp;")})},c.fn.bindPasteFilter=function(){function a(e){if(e&&e.nodeType&&e.nodeName){var f,h=e.nodeName.toLowerCase(),i=e.nodeType;if(3===i||1===i){if(f=b(e),"div"===h)return void b.each(e.childNodes,function(){a(this)});if(j.indexOf(h)>=0)g+=c(e);else if(3===i)g+="<p>"+e.textContent+"</p>";else if("br"===h)g+="<br/>";else{if(["meta","style","script","object","form","iframe","hr"].indexOf(h)>=0)return;f=b(d(e)),g+=b("<div>").append(f.clone()).html()}}}}function c(a){var c,e=a.nodeName.toLowerCase(),f="",g="";return["blockquote"].indexOf(e)>=0?(c=b(a),"<"+e+">"+c.text()+"</"+e+">"):["p","h1","h2","h3","h4","h5"].indexOf(e)>=0?(a=d(a),c=b(a),f=c.html(),f=f.replace(/<.*?>/gi,function(a){return"</a>"===a||0===a.indexOf("<a ")||0===a.indexOf("<img ")?a:""}),"<"+e+">"+f+"</"+e+">"):["ul","ol"].indexOf(e)>=0?(c=b(a),c.children().each(function(){var a=b(d(this)),c=a.html();c=c.replace(/<.*?>/gi,function(a){return"</a>"===a||0===a.indexOf("<a ")||0===a.indexOf("<img ")?a:""}),g+="<li>"+c+"</li>"}),"<"+e+">"+g+"</"+e+">"):(c=b(d(a)),b("<div>").append(c).html())}function d(a){var c=a.attributes||[],e=[],f=["href","target","src","alt","rowspan","colspan"];b.each(c,function(a,b){b&&2===b.nodeType&&e.push(b.nodeName)}),b.each(e,function(b,c){f.indexOf(c)<0&&a.removeAttribute(c)});var g=a.childNodes;return g.length&&b.each(g,function(a,b){d(b)}),a}var e=this,f=e.editor,g="",h=e.$txt,i=f.config.legalTags,j=i.split(",");h.on("paste.ui.editor",function(c){if(f.config.pasteFilter){var d=f.getRangeElem().nodeName;if("TD"!==d&&"TH"!==d){g="";var h,i,j=c.clipboardData||c.originalEvent.clipboardData,k=window.clipboardData;if(f.config.pasteText){if(j&&j.getData)h=j.getData("text/plain");else{if(!k||!k.getData)return;h=k.getData("text")}h&&(g="<p>"+h+"</p>")}else if(j&&j.getData)h=j.getData("text/html"),h?(i=b("<div>"+h+"</div>"),a(i.get(0))):(h=j.getData("text/plain"),h&&(h=h.replace(/[ ]/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"</p><p>"),g="<p>"+h+"</p>",g=g.replace(/<p>(https?:\/\/.*?)<\/p>/gi,function(a,b){return'<p><a href="'+b+'" target="_blank">'+b+"</p>"})));else{if(!k||!k.getData)return;if(g=k.getData("text"),!g)return;g="<p>"+g+"</p>",g=g.replace(new RegExp("\n","g"),"</p><p>")}g&&(f.command(c,"insertHtml",g),e.clearEmptyOrNestP())}}})},c.fn.bindFormatText=function(){var c=this,d=(c.editor,c.$txt),e=a.config.legalTags,f=e.split(","),g=(f.length,[]);b.each(f,function(a,b){var c=">\\s*<("+b+")>";g.push(new RegExp(c,"ig"))}),g.push(new RegExp(">\\s*<(li)>","ig")),g.push(new RegExp(">\\s*<(tr)>","ig")),g.push(new RegExp(">\\s*<(code)>","ig")),d.formatText=function(){var a=b("<div>"),c=d.html();return c=c.replace(/\s*</gi,"<"),b.each(g,function(a,b){b.test(c)&&(c=c.replace(b,function(a,b){return">\n<"+b+">"}))}),a.html(c),a.text()}},c.fn.bindHtml=function(){var a=this,c=a.editor,d=a.$txt,e=c.$valueContainer,f=c.valueNodeName;d.html=function(a){var c;return"div"===f&&(c=b.fn.html.call(d,a)),void 0===a?(c=b.fn.html.call(d),c=c.replace(/(href|src)\=\"(.*)\"/gim,function(a,b,c){return b+'="'+c.replace("&amp;","&")+'"'})):(c=b.fn.html.call(d,a),e.val(a)),void 0===a?c:void d.change()}}}),b(function(a,b){var c=a.Txt,d="propertychange change click keyup input paste";c.fn.initHeight=function(){var a=this.editor,b=this.$txt,c=a.$valueContainer.height(),d=a.menuContainer.height(),e=c-d;e=e<50?50:e,b.height(e),a.valueContainerHeight=c,this.initMaxHeight(e,d)},c.fn.initMaxHeight=function(c,d){var e=this.editor,f=e.menuContainer.$menuContainer,g=this.$txt,h=b("<div>");if(window.getComputedStyle&&"max-height"in window.getComputedStyle(g.get(0))){var i=parseInt(e.$valueContainer.css("max-height"));if(isNaN(i))return;if(e.menus.fullscreen)return void a.warn("max-height和『全屏』菜单一起使用时，会有一些问题尚未解决，请暂时不要两个同时使用");e.useMaxHeight=!0,h.css({"max-height":i-d+"px","overflow-y":"auto"}),g.css({height:"auto","overflow-y":"visible","min-height":c+"px"}),h.on("scroll",function(){g.parent().scrollTop()>10?f.addClass("eEditor-menu-shadow"):f.removeClass("eEditor-menu-shadow")}),this.opts.simple||g.wrap(h)}},c.fn.saveSelectionEvent=function(){function a(){g.saveSelection()}function b(){Date.now()-h<100||(h=Date.now(),a())}function c(){e&&clearTimeout(e),e=setTimeout(a,300)}var e,f=this.$txt,g=this.editor,h=Date.now();f.on(d+" focus blur",function(a){b(),c()}),f.on("mousedown.ui.editor",function(){f.on("mouseleave.saveSelection",function(a){b(),c(),g.updateMenuStyle&&g.updateMenuStyle(),g.triggerChange()})}).on("mouseup.ui.editor",function(){f.off("mouseleave.saveSelection")})},c.fn.updateValueEvent=function(){function a(){var a=e.html();c!==a&&(f.onchange&&"function"==typeof f.onchange&&f.onchange.call(f),f.updateValue(),c=a)}var b,c,e=this.$txt,f=this.editor;e.on(d,function(d){null==c&&(c=e.html()),b&&clearTimeout(b),b=setTimeout(a,100)})},c.fn.updateMenuStyleEvent=function(){var a=this.$txt,b=this.editor;a.on(d,function(a){b.updateMenuStyle&&b.updateMenuStyle(),b.triggerChange()})},c.fn.insertEmptyP=function(){var a=this.$txt,c=a.children();return 0===c.length?void a.append(b("<p><br></p>")):void("<br>"!==b.trim(c.last().html()).toLowerCase()&&a.append(b("<p><br></p>")))},c.fn.wrapImgAndText=function(){var a,c,d=this.$txt,e=d.children("img"),f=d[0],g=f.childNodes,h=g.length;for(e.length&&e.each(function(){b(this).wrap("<p>")}),a=0;a<h;a++)c=g[a],3===c.nodeType&&c.textContent&&b.trim(c.textContent)&&b(c).wrap("<p>")},c.fn.clearEmptyOrNestP=function(){var a=this.$txt,c=a.find("p");c.each(function(){var a,c=b(this),d=c.children(),e=d.length,f=b.trim(c.html());return f?void(1===e&&(a=d.first(),a.get(0)&&"P"===a.get(0).nodeName&&c.html(a.html()))):void c.remove()})},c.fn.scrollTop=function(a){var b=this,c=b.editor,d=b.$txt;return c.useMaxHeight?d.parent().scrollTop(a):d.scrollTop(a)},c.fn.showHeightOnHover=function(){function a(a){i||(e.append(h),i=!0);var b=(g.position().top,g.outerHeight(),a.height()),c=a.position().top,d=parseInt(a.css("margin-top"),10),j=parseInt(a.css("padding-top"),10),k=parseInt(a.css("margin-bottom"),10),l=parseInt(a.css("padding-bottom"),10);c+f.height();h.css({height:b+j+d+l+k,top:c+f.height()})}function c(){i&&(h.remove(),i=!1)}var d=this.editor,e=d.$editorContainer,f=d.menuContainer,g=this.$txt,h=b('<i class="height-tip"><i>'),i=!1;g.on("mouseenter.ui.editor","ul,ol,blockquote,p,h1,h2,h3,h4,h5,table,pre",function(c){a(b(c.currentTarget))}).on("mouseleave.ui.editor",function(){c()})}}),b(function(a,b){a.fn.create=function(){var c=this;a.$body&&0!==a.$body.length||(a.$body=b("body"),a.$document=b(document),a.$window=b(window)),c.createMenu&&c.createMenu(),c.eventTxt(),c.renderTxt(),c.renderEditorContainer(),c.initSelection(),c.$txt=c.txt.$txt;var d=a._plugins;d&&d.length&&b.each(d,function(a,b){b.call(c)}),this.trigger("ready")},a.fn.disable=function(){this.txt.$txt.removeAttr("contenteditable"),this.disableMenusExcept(),this._disabled=!0},a.fn.enable=function(){this._disabled=!1,this.txt.$txt.attr("contenteditable","true"),this.enableMenusExcept()},a.fn.destroy=function(){var a=this.$valueContainer,b=this.$editorContainer,c=this.valueNodeName;this.opts.simple?a.removeAttr("contenteditable"):"div"===c?(a.removeAttr("contenteditable"),b.after(a),b.hide()):(a.show(),b.hide());var d=this.txt.$txt;d.children().last().remove(),d.removeClass("eEditor-txt"),d.off(".ui.editor")},a.fn.clear=function(){var a=this,b=a.txt.$txt;b.html("<p><br></p>"),a.restoreSelectionByElem(b.find("p").get(0))},a.fn.renderTxt=function(){var a=this.txt;if(!this.opts.simple){var b=this.$editorContainer;b.append(this.$txt)}this.ready(function(){a.initHeight()})},a.fn.eventTxt=function(){var a=this.txt;a.saveSelectionEvent(),a.updateValueEvent(),a.updateMenuStyleEvent()},a.fn.renderEditorContainer=function(){var a,b,c=this,d=c.$valueContainer,e=c.$editorContainer,f=c.txt.$txt;d===f?(a=c.$prev,b=c.$parent,a&&a.length?a.after(e):b.prepend(e)):(d.after(e),d.hide())}}),window.EDITOR}),function(){var a=window.EDITOR;a.cmds={},a.addCommand=function(b){a.cmds[b.name]={name:b.name,value:null,handler:b.handler,queryState:b.queryState}},a.fn.execCommand=function(b,c){a.cmds[b]&&a.cmds[b].handler.call(this,this,c)},a.fn.queryCommandValue=function(b){var c=b;a.cmds[b]&&a.cmds[b].systemCmd&&(c=a.cmds[b].systemCmd);var d="";try{d=document.queryCommandValue(c)}catch(e){}return d}}(),function(){var a=window.EDITOR;a.fn.on=function(a,b){this.eventHandlers||(this.eventHandlers={}),this.eventHandlers[a]||(this.eventHandlers[a]=[]),this.eventHandlers[a].push(b)},a.fn.trigger=function(a){if(this.eventHandlers&&this.eventHandlers[a])for(var b=this.eventHandlers[a],c=0;c<b.length;c++)b[c]()},a.ready=function(b){a.readyFns||(a.readyFns=[]),a.readyFns.push(b)},a.readyHeadler=function(){var b=a.readyFns;if(b)for(var c=0;c<b.length;c++)b[c].call(this)}}(),function(){var a=function(a){var b=window.EDITOR;b&&a(b,$)};a(function(a,b){a.config.menuFixed=0,a.config.menus=["source","|","bold","underline","italic","strikethrough","eraser","forecolor","bgcolor","|","quote","fontfamily","fontsize","head","unorderlist","orderlist","alignleft","aligncenter","alignright","|","link","unlink","table","emotion","|","img","video","location","insertcode","|","undo","redo","fullscreen"],a.fn.initUi=function(){this.addMenuContainer(),this.menus={}},a.fn.updateMenuStyle=function(){function a(){editor.hideDropPanelAndModal()}var c=this.menus;b.each(c,function(a,b){b.updateSelected()}),setTimeout(a,200)},a.fn.enableMenusExcept=function(a){this._disabled||(a=a||[],"string"==typeof a&&(a=[a]),b.each(this.menus,function(b,c){a.indexOf(b)>=0||c.disabled(!1)}))},a.fn.disableMenusExcept=function(a){this._disabled||(a=a||[],"string"==typeof a&&(a=[a]),b.each(this.menus,function(b,c){a.indexOf(b)>=0||c.disabled(!0)}))},a.fn.hideDropPanelAndModal=function(){var a=this.menus;b.each(a,function(a,b){var c=b.dropPanel||b.dropList||b.modal;c&&c.hide&&c.hide()})}}),a(function(a,b){a.fn.createMenu=function(){editor=this,editor.addMenus(),editor.renderMenus(),editor.renderMenuContainer(),editor.eventMenus(),editor.eventMenuContainer()}}),a(function(a,b){var c=function(a){this.editor=a,this.init()};c.fn=c.prototype,a.MenuContainer=c}),a(function(a,b){var c=a.MenuContainer;c.fn.init=function(){var a=this,c=b('<div class="eEditor-menu-container clearfix"></div>');a.$menuContainer=c,a.changeShadow()},c.fn.changeShadow=function(){var a=this.$menuContainer,b=this.editor,c=b.txt.$txt;c.on("scroll",function(){c.scrollTop()>10?a.addClass("eEditor-menu-shadow"):a.removeClass("eEditor-menu-shadow")})}}),a(function(a,b){var c=a.MenuContainer;c.fn.render=function(){var a=this.$menuContainer,b=this.editor.$editorContainer;b.append(a)},c.fn.height=function(){var a=this.$menuContainer;return a.height()},c.fn.appendMenu=function(a,b){return this._addGroup(a),this._addOneMenu(b)},c.fn._addGroup=function(a){var c,d=this.$menuContainer;this.$currentGroup&&this.currentGroupIdx===a||(c=b('<div class="menu-group clearfix"></div>'),d.append(c),this.$currentGroup=c,this.currentGroupIdx=a)},c.fn._addOneMenu=function(a){var c=a.$domNormal,d=a.$domSelected,e=this.$currentGroup,f=b('<div class="menu-item clearfix" title="'+a.title+'"></div>');return d.hide(),f.append(c).append(d),e.append(f),f}}),a(function(a,b){var c=function(a){this.editor=a.editor,this.id=a.id,this.title=a.title,this.$domNormal=a.$domNormal,this.$domSelected=a.$domSelected||a.$domNormal,this.commandName=a.commandName,this.commandValue=a.commandValue,this.commandNameSelected=a.commandNameSelected||a.commandName,this.commandValueSelected=a.commandValueSelected||a.commandValue};c.fn=c.prototype,a.Menu=c}),a(function(a,b){var c=a.Menu;c.fn.initUI=function(){var c=this.editor,d=c.UI.menus,e=this.id,f=d[e];this.$domNormal&&this.$domSelected||(null==f&&(a.warn('editor.UI配置中，没有菜单 "'+e+'" 的UI配置，只能取默认值'),f=d.default),this.$domNormal=b(f.normal),/^\./.test(f.selected)?this.$domSelected=this.$domNormal.clone().addClass(f.selected.slice(1)):this.$domSelected=b(f.selected))}}),a(function(a,b){var c=a.Menu;c.fn.render=function(a){this.initUI();var b=this.editor,c=b.menuContainer,d=(c.appendMenu(a,this),this.onRender);d&&"function"==typeof d&&d.call(this)},c.fn.bindEvent=function(){var b=this,c=b.$domNormal,d=b.$domSelected,e=b.clickEvent;e||(e=function(c){var d=b.dropPanel||b.dropList||b.modal;if(d&&d.show)return void(d.isShowing?d.hide():d.show());var e,f,g=b.editor,h=b.selected;h?(e=b.commandNameSelected,f=b.commandValueSelected):(e=b.commandName,f=b.commandValue),e?(console.log(e,f),g.command(c,e,f)):(a.warn('菜单 "'+b.id+'" 未定义click事件'),c.preventDefault())});var f=b.clickEventSelected||e;c.click(function(a){b.disabled()||(e.call(b,a),b.updateSelected()),a.preventDefault()}),d.click(function(a){b.disabled()||(f.call(b,a),b.updateSelected()),a.preventDefault()})},c.fn.updateSelected=function(){var a=this,b=(a.editor,a.updateSelectedEvent);b||(b=function(){var a=this,b=(a.editor,a.commandName),c=a.commandValue;if(c){if(document.queryCommandValue(b).toLowerCase()===c.toLowerCase())return!0}else if(document.queryCommandState(b))return!0;return!1});var c=b.call(a);c=!!c,a.changeSelectedState(c)},c.fn.changeSelectedState=function(a){var b=this,c=b.selected;if(null!=a&&"boolean"==typeof a){if(c===a)return;b.selected=a,a?(b.$domNormal.hide(),b.$domSelected.show()):(b.$domNormal.show(),b.$domSelected.hide())}},c.fn.active=function(a){return null==a?this._activeState:void(this._activeState=a)},c.fn.activeStyle=function(a){var b=(this.selected,this.$domNormal),c=this.$domSelected;a?(b.addClass("active"),c.addClass("active")):(b.removeClass("active"),c.removeClass("active")),this.active(a)},c.fn.disabled=function(a){if(null==a)return!!this._disabled;if(this._disabled!==a){var b=this.$domNormal,c=this.$domSelected;a?(b.addClass("disable"),c.addClass("disable")):(b.removeClass("disable"),c.removeClass("disable")),this._disabled=a}}}),a(function(a,b){var c=function(a,b,c){this.editor=a,this.menu=b,this.data=c.data,this.tpl=c.tpl,this.selectorForELemCommand=c.selectorForELemCommand,this.beforeEvent=c.beforeEvent,this.afterEvent=c.afterEvent,this.init()};c.fn=c.prototype,a.DropList=c}),a(function(a,b){var c=a.DropList;c.fn.init=function(){var a=this;a.initDOM(),a.bindEvent(),a.initHideEvent()},c.fn.initDOM=function(){var a,c,d=this,e=d.data,f=d.tpl||"<span>{#title}</span>",g=b('<div class="eEditor-drop-list clearfix"></div>');b.each(e,function(d,e){a=f.replace(/{#commandValue}/gi,d).replace(/{#title}/gi,e),c=b('<a href="#" commandValue="'+d+'"></a>'),c.append(a),g.append(c)}),d.$list=g},c.fn.bindEvent=function(){var a=this,c=a.editor,d=a.menu,e=d.commandName,f=a.selectorForELemCommand,g=a.$list,h=a.beforeEvent,i=a.afterEvent;g.on("click","a[commandValue]",function(a){h&&"function"==typeof h&&h.call(a);var g=b(a.currentTarget).attr("commandValue");d.selected&&c.isRangeEmpty()&&f?c.commandForElem(f,a,e,g):c.command(a,e,g),i&&"function"==typeof i&&i.call(a)})},c.fn.initHideEvent=function(){var c=this,d=c.$list.get(0);a.$body.on("click",function(a){if(c.isShowing){var e,f=a.target,g=c.menu;e=g.selected?g.$domSelected.get(0):g.$domNormal.get(0),e===f||b.contains(e,f)||d===f||b.contains(d,f)||c.hide()}}),a.$window.scroll(function(){c.hide()}),a.$window.on("resize",function(){c.hide()})}}),a(function(a,b){var c=a.DropList;c.fn._render=function(){var a=this,b=a.editor,c=a.$list;b.$editorContainer.append(c),a.rendered=!0},c.fn._position=function(){var a=this,b=a.$list,c=a.editor,d=a.menu,e=c.menuContainer.$menuContainer,f=d.selected?d.$domSelected:d.$domNormal,g=f.offsetParent().position(),h=g.top,i=g.left,j=f.offsetParent().height(),k=f.offsetParent().width(),l=b.outerWidth(),m=c.txt.$txt.outerWidth(),n=h+j,o=i+k/2,p=0-k/2,q=o+l-m;q>-10&&(p=p-q-10),b.css({top:n,left:o,"margin-left":p}),c._isMenufixed&&(n+=e.offset().top+e.outerHeight()-b.offset().top,b.css({top:n}))},c.fn.show=function(){var a=this,b=a.menu;if(a.rendered||a._render(),!a.isShowing){var c=a.$list;c.show(),a._position(),a.isShowing=!0,b.activeStyle(!0)}},c.fn.hide=function(){var a=this,b=a.menu;if(a.isShowing){var c=a.$list;c.hide(),a.isShowing=!1,b.activeStyle(!1)}}}),a(function(a,b){var c=function(a,b,c){this.editor=a,this.menu=b,this.$content=c.$content,this.width=c.width||200,this.height=c.height,this.onRender=c.onRender,this.init()};c.fn=c.prototype,a.DropPanel=c}),a(function(a,b){var c=a.DropPanel;c.fn.init=function(){var a=this;a.initDOM(),a.initHideEvent()},c.fn.initDOM=function(){var a=this,c=a.$content,d=a.width,e=a.height,f=b('<div class="eEditor-drop-panel clearfix"></div>'),g=b('<div class="tip-triangle"></div>');f.css({width:d,height:e?e:"auto"}),f.append(g),f.append(c),a.$panel=f,a.$triangle=g},c.fn.initHideEvent=function(){var c=this,d=c.$panel.get(0);a.$body.on("click",function(a){if(c.isShowing){var e,f=a.target,g=c.menu;e=g.selected?g.$domSelected.get(0):g.$domNormal.get(0),e===f||b.contains(e,f)||d===f||b.contains(d,f)||c.hide()}}),a.$window.scroll(function(a){c.hide()}),a.$window.on("resize",function(){c.hide()})}}),a(function(a,b){var c=a.DropPanel;c.fn._render=function(){var a=this,b=a.onRender,c=a.editor,d=a.$panel;c.$editorContainer.append(d),b&&b.call(a),a.rendered=!0},c.fn._position=function(){var a=this,b=a.$panel,c=a.$triangle,d=a.editor,e=d.menuContainer.$menuContainer,f=a.menu,g=f.selected?f.$domSelected:f.$domNormal,h=g.offsetParent().position(),i=h.top,j=h.left,k=g.offsetParent().height(),l=g.offsetParent().width(),m=b.outerWidth(),n=d.txt.$txt.outerWidth(),o=i+k,p=j+l/2,q=0-m/2,r=q;0-q>p-10&&(q=0-(p-10));var s=p+m+q-n;s>-10&&(q=q-s-10),b.css({top:o,left:p,"margin-left":q}),d._isMenufixed&&(o+=e.offset().top+e.outerHeight()-b.offset().top,b.css({top:o})),c.css({"margin-left":r-q-5})},c.fn.focusFirstInput=function(){var a=this,c=a.$panel;c.find("input[type=text],textarea").each(function(){var a=b(this);if(null==a.attr("disabled"))return a.focus(),!1})},c.fn.show=function(){var a=this,b=a.menu;if(a.rendered||a._render(),!a.isShowing){var c=a.$panel;c.show(),a._position(),a.isShowing=!0,b.activeStyle(!0),a.focusFirstInput()}},c.fn.hide=function(){var a=this,b=a.menu;if(a.isShowing){var c=a.$panel;c.hide(),a.isShowing=!1,b.activeStyle(!1)}}}),a(function(a,b){var c=function(a,b,c){this.editor=a,this.menu=b,this.$content=c.$content,this.init()};c.fn=c.prototype,a.Modal=c}),a(function(a,b){var c=a.Modal;c.fn.init=function(){var a=this;a.initDom(),a.initHideEvent()},c.fn.initDom=function(){var a=this,c=a.$content,d=b('<div class="eEditor-modal"></div>'),e=b('<div class="eEditor-modal-close"><i class="icon icon-close"></i></div>');d.append(e),d.append(c),a.$modal=d,a.$close=e},c.fn.initHideEvent=function(){var c=this,d=c.$close,e=c.$modal.get(0);d.click(function(){c.hide()}),a.$body.on("click",function(a){if(c.isShowing){var d,f=a.target,g=c.menu;g&&(d=g.selected?g.$domSelected.get(0):g.$domNormal.get(0),d===f||b.contains(d,f))||e===f||b.contains(e,f)||c.hide()}})}}),a(function(a,b){var c=a.Modal;c.fn._render=function(){var b=this,c=b.editor,d=b.$modal;d.css("z-index",c.config.zindex+10+""),a.$body.append(d),b.rendered=!0},c.fn._position=function(){var b=this,c=b.$modal,d=c.offset().top,e=c.outerWidth(),f=c.outerHeight(),g=0-e/2,h=0-f/2,i=a.$window.scrollTop();f/2>d&&(h=0-d),c.css({"margin-left":g+"px","margin-top":h+i+"px"})},c.fn.show=function(){var a=this,b=a.menu;if(a.rendered||a._render(),!a.isShowing){a.isShowing=!0;var c=a.$modal;c.show(),a._position(),b&&b.activeStyle(!0)}},c.fn.hide=function(){var a=this,b=a.menu;if(a.isShowing){a.isShowing=!1;var c=a.$modal;c.hide(),b&&b.activeStyle(!1)}}}),a(function(a,b){a.UI={},a.UI.menus={default:{normal:'<a href="#" tabindex="-1"><i class="icon icon-dot"></i></a>',selected:".selected"}}}),a(function(a,b){a.fn.initDefaultConfig=function(){var c=this;c.UI=b.extend({},a.UI)},a.fn.addMenuContainer=function(){var b=this;b.menuContainer=new a.MenuContainer(b)}}),a(function(a,b){a.createMenuFns=[],a.createMenu=function(b){a.createMenuFns.push(b)},a.fn.addMenus=function(){function c(a){return e.indexOf(a)>=0}var d=this,e=d.config.menus;b.each(a.createMenuFns,function(a,b){b.call(d,c)})}}),a(function(a,b){a.fn.renderMenus=function(){var a,c=this,d=c.menus,e=c.config.menus,f=(c.menuContainer,0);b.each(e,function(b,c){return"|"===c?void f++:(a=d[c],void(a&&a.render(f)))})},a.fn.renderMenuContainer=function(){var a=this,b=a.menuContainer;a.$editorContainer;b.render()},a.fn.eventMenus=function(){var a=this.menus;b.each(a,function(a,b){b.bindEvent()})},a.fn.eventMenuContainer=function(){},a.plugin(function(){function a(){g||(n.append(o).append(p),k.$editorContainer.append(n),g=!0)}function c(){if(f){var a=f.position(),b=a.left,c=a.top,d=f.height(),e=c+d+5,g=k.menuContainer.height(),h=k.txt.$txt.outerHeight();e>g+h&&(e=g+h+5),n.css({top:e,left:b})}}function d(){if(!q&&f){a(),n.show();var b=f.attr("href");p.attr("href",b),c(),q=!0}}function e(){q&&f&&(n.hide(),q=!1)}var f,g,h,i,j,k=this,l=k.config.lang,m=k.txt.$txt,n=b('<div class="txt-toolbar"></div>'),o=b('<div class="tip-triangle"></div>'),p=b('<a href="#" target="_blank"><i class="icon icon-link"></i> '+l.openLink+"</a>"),q=!1;m.on("mouseenter","a",function(a){h&&clearTimeout(h),h=setTimeout(function(){var c=a.currentTarget,g=b(c);f=g;var h=g.children("img");h.length&&(h.click(function(a){e()}),h.hasClass("clicked"))||d()},500)}).on("mouseleave","a",function(a){i&&clearTimeout(i),i=setTimeout(e,500)}).on("click keydown scroll",function(a){setTimeout(e,100)}),n.on("mouseenter",function(a){i&&clearTimeout(i)}).on("mouseleave",function(a){j&&clearTimeout(j),j=setTimeout(e,500)})})})}(),function(a){var b=window.EDITOR;b.createMenu(function(c){var d="alignleft";if(c(d)){var e=this,f=e.config.lang,g=new b.Menu({editor:e,id:d,title:f.alignleft,commandName:"JustifyLeft"});g.updateSelectedEvent=function(){var b=e.getRangeElem();return b=e.getSelfOrParentByName(b,"p,h1,h2,h3,h4,h5,li",function(b){var c;return!!(b&&b.style&&null!=b.style.cssText&&(c=b.style.cssText,c&&/text-align:\s*left;/.test(c)))||"left"===a(b).attr("align")}),!!b},e.menus[d]=g,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-align-left"></i></a>',selected:".selected"
}}}),b.createMenu(function(c){var d="aligncenter";if(c(d)){var e=this,f=e.config.lang,g=new b.Menu({editor:e,id:d,title:f.aligncenter,commandName:"JustifyCenter"});g.updateSelectedEvent=function(){var b=e.getRangeElem();return b=e.getSelfOrParentByName(b,"p,h1,h2,h3,h4,h5,li",function(b){var c;return!!(b&&b.style&&null!=b.style.cssText&&(c=b.style.cssText,c&&/text-align:\s*center;/.test(c)))||"center"===a(b).attr("align")}),!!b&&(console.log("不肯把"),!0)},e.menus[d]=g,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-align-center"></i></a>',selected:".selected"}}}),b.createMenu(function(c){var d="alignright";if(c(d)){var e=this,f=e.config.lang,g=new b.Menu({editor:e,id:d,title:f.alignright,commandName:"JustifyRight"});g.updateSelectedEvent=function(){var b=e.getRangeElem();return b=e.getSelfOrParentByName(b,"p,h1,h2,h3,h4,h5,li",function(b){var c;return!!(b&&b.style&&null!=b.style.cssText&&(c=b.style.cssText,c&&/text-align:\s*right;/.test(c)))||"right"===a(b).attr("align")}),!!b},e.menus[d]=g,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-align-right"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(a){var c="bold";if(a(c)){var d=this,e=d.config.lang,f=new b.Menu({editor:d,id:c,title:e.bold,commandName:"Bold"});f.clickEventSelected=function(a){var b=d.isRangeEmpty();b?(console.log("呵呵"),d.commandForElem("b,strong,h1,h2,h3,h4,h5",a,"Bold")):d.command(a,"Bold")},d.menus[c]=f,b.UI.menus[c]={normal:'<a href="#" tabindex="-1"><i class="icon icon-bold"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.config.emotionsShow="icon",b.config.emotions={weibo:{title:"微博表情",data:[{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/7a/shenshou_thumb.gif",value:"[草泥马]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/60/horse2_thumb.gif",value:"[神马]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/fuyun_thumb.gif",value:"[浮云]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c9/geili_thumb.gif",value:"[给力]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/f2/wg_thumb.gif",value:"[围观]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/70/vw_thumb.gif",value:"[威武]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6e/panda_thumb.gif",value:"[熊猫]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/81/rabbit_thumb.gif",value:"[兔子]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/bc/otm_thumb.gif",value:"[奥特曼]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/15/j_thumb.gif",value:"[囧]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/89/hufen_thumb.gif",value:"[互粉]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/c4/liwu_thumb.gif",value:"[礼物]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/ac/smilea_thumb.gif",value:"[呵呵]"},{icon:"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/0b/tootha_thumb.gif",value:"[哈哈]"}]}},b.createMenu(function(c){function d(b,c){a.each(b,function(b,d){var e=d.icon||d.url,g=d.value||d.title,h="icon"===j?e:g,i=a('<a href="#" commandValue="'+h+'"></a>'),k=a("<img>");k.attr("_src",e),i.append(k),c.append(i),f.emotionUrls.push(e)})}var e="emotion";if(c(e)){var f=this,g=f.config,h=g.lang,i=g.emotions,j=g.emotionsShow;f.emotionUrls=[];var k=new b.Menu({editor:f,id:e,title:h.emotion}),l=a('<div class="panel-tab"></div>'),m=a('<div class="tab-container"></div>'),n=a('<div class="content-container emotion-content-container"></div>');a.each(i,function(c,e){var f=e.title,g=e.data;b.log("正在处理 "+f+" 表情的数据...");var h=a('<a href="#">'+f+" </a>");m.append(h);var i=a('<div class="content"></div>');if(n.append(i),h.click(function(a){m.children().removeClass("selected"),n.children().removeClass("selected"),i.addClass("selected"),h.addClass("selected"),a.preventDefault()}),"string"==typeof g)b.log("将通过 "+g+" 地址ajax下载表情包"),a.get(g,function(c){c=a.parseJSON(c),b.log("下载完毕，得到 "+c.length+" 个表情"),d(c,i)});else{if(!(Object.prototype.toString.call(g).toLowerCase().indexOf("array")>0))return void b.error("data 数据格式错误，请修改为正确格式");d(g,i)}}),l.append(m).append(n),m.children().first().addClass("selected"),n.children().first().addClass("selected"),n.on("click","a[commandValue]",function(b){var c=a(b.currentTarget),d=c.attr("commandValue");"icon"===j?f.command(b,"InsertImage",d):f.command(b,"insertHtml","<span>"+d+"</span>"),b.preventDefault()}),k.dropPanel=new b.DropPanel(f,k,{$content:l,width:350}),k.clickEvent=function(c){var d=this,e=d.dropPanel;return e.isShowing?void e.hide():(e.show(),void(d.imgLoaded||(n.find("img").each(function(){var c=a(this),d=c.attr("_src");c.on("error",function(){b.error("加载不出表情图片 "+d)}),c.attr("src",d),c.removeAttr("_src")}),d.imgLoaded=!0)))},f.menus[e]=k,b.UI.menus[e]={normal:'<a href="#" tabindex="-1"><i class="icon icon-smile"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(c){var d="eraser";if(c(d)){var e=this,f=e.config.lang,g=new b.Menu({editor:e,id:d,title:f.eraser,commandName:"RemoveFormat"});g.clickEvent=function(b){function c(){var b,c,d,e,f,h,i,j=this;b=j.getRangeElem(),e=j.getSelfOrParentByName(b,"blockquote"),e&&(f=a(e),g=a("<p>"+f.text()+"</p>"),f.after(g).remove()),c=j.getSelfOrParentByName(b,"p,h1,h2,h3,h4,h5"),c&&(d=a(c),g=a("<p>"+d.text()+"</p>"),d.after(g).remove()),h=j.getSelfOrParentByName(b,"ul,ol"),h&&(i=a(h),g=a("<p>"+i.text()+"</p>"),i.after(g).remove())}function d(){var a=this;g&&a.restoreSelectionByElem(g.get(0))}var f=e.isRangeEmpty();if(!f)return void e.command(b,"RemoveFormat");var g;e.customCommand(b,c,d)},e.menus[d]=g,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-eraser"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.config.familys=["宋体","黑体","楷体","微软雅黑","Arial","Verdana","Georgia","Times New Roman","Microsoft JhengHei","Trebuchet MS","Courier New","Impact","Comic Sans MS","Consolas"],b.createMenu(function(c){var d="fontfamily";if(c(d)){var e=this,f=e.config.lang,g=e.config.familys,h=new b.Menu({editor:e,id:d,title:f.fontfamily,commandName:"fontName"}),i={};a.each(g,function(a,b){i[b]=b});var j='<span style="font-family:{#commandValue};">{#title}</span>';h.dropList=new b.DropList(e,h,{data:i,tpl:j,selectorForELemCommand:"font[face]"}),h.updateSelectedEvent=function(){var a=e.getRangeElem();return a=e.getSelfOrParentByName(a,"font[face]"),!!a},e.menus[d]=h,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-font"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.config.fontsizes={1:"12px",2:"13px",3:"16px",4:"18px",5:"24px",6:"32px",7:"48px"},b.createMenu(function(a){var c="fontsize";if(a(c)){var d=this,e=d.config.lang,f=d.config.fontsizes,g=new b.Menu({editor:d,id:c,title:e.fontsize,commandName:"fontSize"}),h=f,i='<span style="font-size:{#title};">{#title}</span>';g.dropList=new b.DropList(d,g,{data:h,tpl:i,selectorForELemCommand:"font[size]"}),g.updateSelectedEvent=function(){var a=d.getRangeElem();return a=d.getSelfOrParentByName(a,"font[size]"),!!a},d.menus[c]=g,b.UI.menus[c]={normal:'<a href="#" tabindex="-1"><i class="icon icon-font-size"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.config.colors={"#880000":"暗红色","#800080":"紫色","#ff0000":"红色","#ff00ff":"鲜粉色","#000080":"深蓝色","#0000ff":"蓝色","#00ffff":"湖蓝色","#008080":"蓝绿色","#008000":"绿色","#808000":"橄榄色","#00ff00":"浅绿色","#ffcc00":"橙黄色","#808080":"灰色","#c0c0c0":"银色","#000000":"黑色","#ffffff":"白色"},b.createMenu(function(c){var d="forecolor";if(c(d)){var e=this,f=e.config.lang,g=e.config.colors,h=new b.Menu({editor:e,id:d,title:f.forecolor}),i=a("<div></div>");a.each(g,function(a,b){i.append(['<a href="#" class="color-item"','    title="'+b+'" commandValue="'+a+'" ','    style="color: '+a+'" ','><i class="icon icon-dot"></i></a>'].join(""))}),i.on("click","a[commandValue]",function(b){var c=a(this),d=c.attr("commandValue");h.selected&&e.isRangeEmpty()?e.commandForElem("font[color]",b,"forecolor",d):e.command(b,"forecolor",d)}),h.dropPanel=new b.DropPanel(e,h,{$content:i,width:125}),h.updateSelectedEvent=function(){var a=e.getRangeElem();return a=e.getSelfOrParentByName(a,"font[color]"),!!a},e.menus[d]=h,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-font-color"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(a){function c(a){g.queryCommandState("InsertOrderedList")?(f=!0,g.command(a,"InsertOrderedList")):f=!1}function d(a){f&&g.command(a,"InsertOrderedList")}var e="head";if(a(e)){var f,g=this,h=g.config.lang,i=new b.Menu({editor:g,id:e,title:h.head,commandName:"formatBlock"}),j={"<h1>":"标题1","<h2>":"标题2","<h3>":"标题3","<h4>":"标题4","<h5>":"标题5"},k="{#commandValue}{#title}";i.dropList=new b.DropList(g,i,{data:j,tpl:k,beforeEvent:c,afterEvent:d}),i.updateSelectedEvent=function(){var a=g.getRangeElem();return a=g.getSelfOrParentByName(a,"h1,h2,h3,h4,h5"),!!a},g.menus[e]=i,b.UI.menus[e]={normal:'<a href="#" tabindex="-1"><i class="icon icon-head"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.userAgent.indexOf("MSIE 8")>0||b.plugin(function(){function c(b,c){if(j){var d,e,f=function(){null!=c&&(p=c)},g=!1,h=j.parent();if("a"===h.get(0).nodeName.toLowerCase()?(e=h,g=!0):e=a('<a target="_blank"></a>'),null==c)return e.attr("href")||"";if(""===c)g&&(d=function(){j.unwrap()});else{if(c===p)return;d=function(){e.attr("href",c),g||j.wrap(e)}}d&&k.customCommand(b,d,f)}}function d(){q||(e(),f(),u.append(v).append(w).append(x).append(y).append(z).append(A).append(B).append(C),D.append(E).append(G).append(F),s.append(t).append(u).append(D),k.$editorContainer.append(s).append(r),q=!0)}function e(){function b(a,b){d&&k.customCommand(a,d,b)}var d;v.click(function(a){c(a,""),d=function(){j.remove()},b(a,function(){setTimeout(h,100)})}),x.click(function(a){d=function(){var a=j.get(0),b=a.width,c=a.height;b=1.1*b,c=1.1*c,j.css({width:b+"px",height:c+"px"})},b(a,function(){setTimeout(g)})}),w.click(function(a){d=function(){var a=j.get(0),b=a.width,c=a.height;b=.9*b,c=.9*c,j.css({width:b+"px",height:c+"px"})},b(a,function(){setTimeout(g)})}),y.click(function(a){d=function(){j.parents("p").css({"text-align":"left"}).attr("align","left")},b(a,function(){setTimeout(h,100)})}),A.click(function(a){d=function(){j.parents("p").css({"text-align":"right"}).attr("align","right")},b(a,function(){setTimeout(h,100)})}),z.click(function(a){d=function(){j.parents("p").css({"text-align":"center"}).attr("align","center")},b(a,function(){setTimeout(h,100)})}),B.click(function(a){a.preventDefault(),p=c(a),E.val(p),u.hide(),D.show()}),F.click(function(b){b.preventDefault();var d=a.trim(E.val());d&&c(b,d),setTimeout(h)}),G.click(function(a){a.preventDefault(),E.val(p),u.show(),D.hide()}),C.click(function(a){a.preventDefault(),c(a,""),setTimeout(h)})}function f(){function a(a){var b,h;b=a.pageX-c,h=a.pageY-d;var k=e+b,l=f+h;r.css({"margin-left":k,"margin-top":l});var m=g+b,n=i+h;j&&j.css({width:m,height:n})}var c,d,e,f,g,i;r.on("mousedown",function(k){j&&(c=k.pageX,d=k.pageY,e=parseFloat(r.css("margin-left"),10),f=parseFloat(r.css("margin-top"),10),g=j.width(),i=j.height(),s.hide(),b.$document.on("mousemove._dragResizeImg",a),b.$document.on("mouseup._dragResizeImg",function(a){b.$document.off("mousemove._dragResizeImg"),b.$document.off("mouseup._dragResizeImg"),h(),r.css({"margin-left":e,"margin-top":f}),H=!1}),H=!0)})}function g(){if(!k._disabled&&null!=j){j.addClass("clicked");var a=j.position(),b=a.top,c=a.left,d=j.outerHeight(),e=j.outerWidth();r.css({top:b+d,left:c+e});var f=b+d,g=c,h=0,i=o.position().top,l=o.outerHeight();f>i+l?f=i+l:r.show(),s.show();var m=s.outerWidth();h=e/2-m/2,s.css({top:f+5,left:g,"margin-left":h}),h<0?(s.css("margin-left","0"),t.hide()):t.show(),k.disableMenusExcept()}}function h(){null!=j&&(j.removeClass("clicked"),j=null,s.hide(),r.hide(),k.enableMenusExcept())}function i(b){var c=!1;return k.emotionUrls?(a.each(k.emotionUrls,function(a,d){var e=!1;if(b===d&&(c=!0,e=!0),e)return!1}),c):c}var j,k=this,l=k.config.lang,m=k.txt,n=m.$txt,o=k.useMaxHeight?n.parent():n,p=(k.$editorContainer,""),q=!1,r=a('<div class="img-drag-point"></div>'),s=a('<div class="txt-toolbar"></div>'),t=a('<div class="tip-triangle"></div>'),u=a("<div></div>"),v=a('<a href="#"><i class="icon icon-trash"></i></a>'),w=a('<a href="#"><i class="icon icon-search-minus"></i></a>'),x=a('<a href="#"><i class="icon icon-search-plus"></i></a>'),y=a('<a href="#"><i class="icon icon-align-left"></i></a>'),z=a('<a href="#"><i class="icon icon-align-center"></i></a>'),A=a('<a href="#"><i class="icon icon-align-right"></i></a>'),B=a('<a href="#"><i class="icon icon-link"></i></a>'),C=a('<a href="#"><i class="icon icon-unlink"></i></a>'),D=a('<div style="display:none;"></div>'),E=a('<input type="text" style="height:26px; margin-left:10px; width:200px;"/>'),F=a('<button class="right">'+l.submit+"</button>"),G=a('<button class="right gray">'+l.cancel+"</button>"),H=!1;o.on("mousedown","img",function(a){a.preventDefault()}).on("click","img",function(b){var c=a(b.currentTarget),e=c.attr("src");if(e&&!i(e)){if(d(),j&&j.get(0)===c.get(0))return void setTimeout(h,100);j=c,g(),u.show(),D.hide(),b.preventDefault(),b.stopPropagation()}}).on("click keydown scroll",function(a){H||setTimeout(h,100)})})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(c){var d="link";if(c(d)){var e=this,f=e.config.lang,g=new b.Menu({editor:e,id:d,title:f.link}),h=a("<div></div>"),i=a('<div style="margin:20px 10px;" class="clearfix"></div>'),j=i.clone(),k=i.clone().css("margin","0 10px"),l=a('<input type="text" class="block" placeholder="'+f.text+'"/>'),m=a('<input type="text" class="block" placeholder="'+f.link+'"/>'),n=a('<button class="right">'+f.submit+"</button>"),o=a('<button class="right gray">'+f.cancel+"</button>");i.append(l),j.append(m),k.append(n).append(o),h.append(i).append(j).append(k),g.dropPanel=new b.DropPanel(e,g,{$content:h,width:300}),g.clickEvent=function(a){var b=this,c=b.dropPanel;if(c.isShowing)return void c.hide();l.val(""),m.val("http://");var d="",f=e.getRangeElem();f=e.getSelfOrParentByName(f,"a"),f&&(d=f.href||"");var g="",h=e.isRangeEmpty();h?f&&(g=f.textContent||f.innerHTML):g=e.getRangeText()||"",d&&m.val(d),g&&l.val(g),h?l.removeAttr("disabled"):l.attr("disabled",!0),c.show()},g.updateSelectedEvent=function(){var a=e.getRangeElem();return a=e.getSelfOrParentByName(a,"a"),!!a},o.click(function(a){a.preventDefault(),g.dropPanel.hide()}),n.click(function(c){c.preventDefault();var d,f,h,i,j,k,n=e.getRangeElem(),o=e.getSelfOrParentByName(n,"a"),p=e.isRangeEmpty(),q=e.txt.$txt,r="link"+b.random(),s=a.trim(m.val()),t=a.trim(l.val());return s?(t||(t=s),void(p?o?(d=a(o),h=function(){d.attr("href",s),d.text(t)},i=function(){var a=this;a.restoreSelectionByElem(o)},e.customCommand(c,h,i)):(f='<a href="'+s+'" target="_blank">'+t+"</a>",b.userAgent.indexOf("Firefox")>0&&(f+="<span>&nbsp;</span>"),e.command(c,"insertHtml",f)):(j=q.find("a"),j.attr(r,"1"),e.command(c,"createLink",s),k=q.find("a").not("["+r+"]"),k.attr("target","_blank"),j.removeAttr(r)))):void g.dropPanel.focusFirstInput()}),e.menus[d]=g,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-link"></i></a>',selected:".selected"}}}),b.createMenu(function(c){var d="unlink";if(c(d)){var e=this,f=e.config.lang,g=new b.Menu({editor:e,id:d,title:f.unlink,commandName:"unLink"});g.clickEvent=function(b){function c(){i.after(j).remove()}function d(){e.restoreSelectionByElem(j.get(0))}var f=e.isRangeEmpty();if(!f)return void e.command(b,"unLink");var g=e.getRangeElem(),h=e.getSelfOrParentByName(g,"a");if(!h)return void b.preventDefault();var i=a(h),j=a("<span>"+i.text()+"</span>");e.customCommand(b,c,d)},e.menus[d]=g,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-unlink"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.plugin(function(){function c(){l||(d(),m.append(n).append(o).append(p).append(q),h.$editorContainer.append(m),l=!0)}function d(){function a(a,c){b&&h.customCommand(a,b,c)}var b;o.click(function(c){b=function(){g.remove()},a(c,function(){setTimeout(f,100)})}),q.click(function(c){b=function(){g.css({width:"100%"})},a(c,function(){setTimeout(e)})}),p.click(function(c){b=function(){g.css({width:"auto"})},a(c,function(){setTimeout(e)})})}function e(){if(!h._disabled&&null!=g){g.addClass("clicked");var a=g.position(),b=a.top,c=a.left,d=g.outerHeight(),e=g.outerWidth(),f=b+d,i=c,j=0,l=k.position().top,o=k.outerHeight();f>l+o&&(f=l+o),m.show();var p=m.outerWidth();j=e/2-p/2,m.css({top:f+5,left:i,"margin-left":j}),j<0?(m.css("margin-left","0"),n.hide()):n.show()}}function f(){null!=g&&(g.removeClass("clicked"),g=null,m.hide())}var g,h=this,i=h.txt,j=i.$txt,k=h.useMaxHeight?j.parent():j,l=!1,m=a('<div class="txt-toolbar"></div>'),n=a('<div class="tip-triangle"></div>'),o=a('<a href="#"><i class="icon icon-trash"></i></a>'),p=a('<a href="#"><i class="icon icon-search-minus"></i></a>'),q=a('<a href="#"><i class="icon icon-search-plus"></i></a>');k.on("click","table",function(b){var d=a(b.currentTarget);return c(),g&&g.get(0)===d.get(0)?void setTimeout(f,100):(g=d,e(),b.preventDefault(),void b.stopPropagation())}).on("click keydown scroll",function(a){setTimeout(f,100)}),b.$body.on("click keydown scroll",function(a){setTimeout(f,100)})})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(c){var d="indent";if(c(d)){var e=this,f=new b.Menu({editor:e,id:d,title:"缩进",$domNormal:a('<a href="#" tabindex="-1"><i class="icon icon-indent"></i></a>'),$domSelected:a('<a href="#" tabindex="-1" class="selected"><i class="icon icon-indent"></i></a>')});f.clickEvent=function(b){function c(){d.css("text-indent","2em")}var d,f=e.getRangeElem(),g=e.getSelfOrParentByName(f,"p");return g?(d=a(g),void e.customCommand(b,c)):b.preventDefault()},f.clickEventSelected=function(b){function c(){d.css("text-indent","0")}var d,f=e.getRangeElem(),g=e.getSelfOrParentByName(f,"p");return g?(d=a(g),void e.customCommand(b,c)):b.preventDefault()},f.updateSelectedEvent=function(){var b,c,d=e.getRangeElem(),f=e.getSelfOrParentByName(d,"p");return!!f&&(b=a(f),c=b.css("text-indent"),!(!c||"0px"===c))},e.menus[d]=f}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(a){var c="italic";if(a(c)){var d=this,e=d.config.lang,f=new b.Menu({editor:d,id:c,title:e.italic,commandName:"Italic"});f.clickEventSelected=function(a){var b=d.isRangeEmpty();b?d.commandForElem("i",a,"Italic"):d.command(a,"Italic")},d.menus[c]=f,b.UI.menus[c]={normal:'<a href="#" tabindex="-1"><i class="icon icon-italic"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(c){var d="lineheight";if(c(d)){var e=this;e.commandHooks.lineHeight=function(b){var c=e.getRangeElem(),d=e.getSelfOrParentByName(c,"p,h1,h2,h3,h4,h5,pre");d&&a(d).css("line-height",b+"")};var f=new b.Menu({editor:e,id:d,title:"行高",commandName:"lineHeight",$domNormal:a('<a href="#" tabindex="-1"><i class="icon icon-lineheight"></i></a>'),$domSelected:a('<a href="#" tabindex="-1" class="selected"><i class="icon-lineheight"></i></a>')}),g={"1.0":"1.0倍",1.5:"1.5倍",1.8:"1.8倍","2.0":"2.0倍",2.5:"2.5倍","3.0":"3.0倍"},h='<span style="line-height:{#commandValue}">{#title}</span>';f.dropList=new b.DropList(e,f,{data:g,tpl:h}),e.menus[d]=f}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(a){var c="orderlist";if(a(c)){var d=this,e=d.config.lang,f=new b.Menu({editor:d,id:c,title:e.orderlist,commandName:"InsertOrderedList"});d.menus[c]=f,b.UI.menus[c]={normal:'<a href="#" tabindex="-1"><i class="icon icon-list-number"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(c){var d="quote";if(c(d)){var e=this,f=e.config.lang,g=new b.Menu({editor:e,id:d,title:f.quote,commandName:"formatBlock",commandValue:"blockquote"});g.clickEvent=function(b){function c(){h=a("<p>"+f.text()+"</p>"),f.after(h).remove(),h.wrap("<blockquote>")}function d(){var a=this;h&&a.restoreSelectionByElem(h.get(0))}var f,g=e.getRangeElem();if(!g)return void b.preventDefault();var h,i=e.getSelfOrParentByName(g,"blockquote");return i?void b.preventDefault():(g=e.getLegalTags(g),f=a(g),f.text()?g?void e.customCommand(b,c,d):void e.command(b,"formatBlock","blockquote"):void 0)},g.clickEventSelected=function(b){function c(){var b,c;if(b=a(g),c=b.children(),c.length)return c.each(function(c){var d=a(this);"P"===d.get(0).nodeName?b.after(d):b.after("<p>"+d.text()+"</p>"),h=d}),void b.remove()}function d(){var a=this;h&&a.restoreSelectionByElem(h.get(0))}var f,g,h;return f=e.getRangeElem(),(g=e.getSelfOrParentByName(f,"blockquote"))?void e.customCommand(b,c,d):void b.preventDefault()},g.updateSelectedEvent=function(){var a,b=this,c=b.editor;return a=c.getRangeElem(),a=c.getSelfOrParentByName(a,"blockquote"),!!a},e.menus[d]=g,b.UI.menus[d]={normal:'<a href="#" tabindex="-1"><i class="icon icon-quote-left"></i></a>',selected:".selected"},e.ready(function(){var b=this,c=b.txt.$txt,d=!1;c.on("keydown",function(c){if(13!==c.keyCode)return void(d=!1);var e=b.getRangeElem();if(e=b.getSelfOrParentByName(e,"blockquote"),!e)return void(d=!1);if(!d)return void(d=!0);var f=b.getRangeElem(),g=a(f);g.length&&g.parent().after(g),b.restoreSelectionByElem(f,"start"),d=!1,c.preventDefault()})}),e.ready(function(){function b(){d&&d.remove()}function c(){if(d){var a=d.prev();a.length?e.restoreSelectionByElem(a.get(0)):e.initSelection()}}var d,e=this,f=e.txt.$txt;f.on("keydown",function(f){if(8===f.keyCode){var g=e.getRangeElem();if(g=e.getSelfOrParentByName(g,"blockquote")){d=a(g);var h=d.text();h||e.customCommand(f,b,c)}}})})}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(c){function d(){var b=i.$codeTextarea,c=g.txt.$txt,d=a.trim(b.val());d||(d="<p><br></p>"),g.config.jsFilter&&(d=d.replace(/<script[\s\S]*?<\/script>/gi,"")),c.html(d)}var e="source";if(c(e)){var f,g=this,h=g.config.lang,i=new b.Menu({editor:g,id:e,title:h.source});i.isShowCode=!1,i.clickEvent=function(b){var c=this,d=c.editor,e=d.txt.$txt,g=e.outerHeight(),h=e.height();c.$codeTextarea||(c.$codeTextarea=a('<textarea class="code-textarea"></textarea>'));var j=c.$codeTextarea;j.css({height:h,"margin-top":g-h}),j.val(e.html()),e.after(j).hide(),j.show(),i.isShowCode=!0,this.updateSelected(),d.disableMenusExcept("source"),f=e.html()},i.clickEventSelected=function(a){var b=this,c=b.editor,e=c.txt.$txt,g=b.$codeTextarea;g&&(d(),g.after(e).hide(),e.show(),i.isShowCode=!1,this.updateSelected(),c.enableMenusExcept("source"),e.html()!==f&&c.onchange&&"function"==typeof c.onchange&&c.onchange.call(c))},i.updateSelectedEvent=function(){return this.isShowCode},g.menus[e]=i,b.UI.menus[e]={normal:'<a href="#" tabindex="-1"><i class="icon icon-code"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(a){var c="strikethrough";if(a(c)){var d=this,e=d.config.lang,f=new b.Menu({editor:d,id:c,title:e.strikethrough,commandName:"StrikeThrough"});f.clickEventSelected=function(a){var b=d.isRangeEmpty();b?d.commandForElem("strike",a,"StrikeThrough"):d.command(a,"StrikeThrough")},d.menus[c]=f,b.UI.menus[c]={normal:'<a href="#" tabindex="-1"><i class="icon icon-strikethrough"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(a){var c="underline";if(a(c)){var d=this,e=d.config.lang,f=new b.Menu({editor:d,id:c,title:e.underline,commandName:"Underline"});f.clickEventSelected=function(a){var b=d.isRangeEmpty();b?d.commandForElem("u,a",a,"Underline"):d.command(a,"Underline")},d.menus[c]=f,b.UI.menus.underline={normal:'<a href="#" tabindex="-1"><i class="icon icon-underline"></i></a>',selected:".selected"}}})}(jQuery),function(a){var b=(window.EDITOR,function(b){var c=window.EDITOR;c&&b(c,a)});b(function(a,b){function c(a){return null==a._redoList&&(a._redoList=[]),a._redoList}function d(a){return null==a._undoList&&(a._undoList=[]),a._undoList}function e(a,b,c){var d=b.val,e=a.txt.$txt.html();if(null!=d){if(d===e)return"redo"===c?void a.redo():"undo"===c?void a.undo():void 0;a.txt.$txt.html(d),a.updateValue(),a.onchange&&"function"==typeof a.onchange&&a.onchange.call(a)}}var f=20;a.fn.undoRecord=function(){var a=this,b=a.txt.$txt,e=b.html(),g=d(a),h=c(a),i=g.length?g[0]:"";e!==i.val&&(h.length&&(h=[]),g.unshift({range:a.currentRange(),val:e}),g.length>f&&g.pop())},a.fn.undo=function(){var a=this,b=d(a),f=c(a);if(b.length){var g=b.shift();f.unshift(g),e(this,g,"undo")}},a.fn.redo=function(){var a=this,b=d(a),f=c(a);if(f.length){var g=f.shift();b.unshift(g),e(this,g,"redo")}}}),b(function(a,b){a.createMenu(function(b){var c="undo";if(b(c)){var d=this,e=d.config.lang,f=new a.Menu({editor:d,id:c,title:e.undo});f.clickEvent=function(a){d.undo()},d.menus[c]=f,a.UI.menus.undo={normal:'<a href="#" tabindex="-1"><i class="icon icon-undo"></i></a>',selected:".selected"},d.ready(function(){function a(){c.undoRecord()}var b,c=this,d=c.txt.$txt;d.on("keydown",function(d){var e=d.keyCode;return d.ctrlKey&&90===e?void c.undo():void(13===e?a():(b&&clearTimeout(b),b=setTimeout(a,1e3)))}),c.undoRecord()})}})}),b(function(a,b){a.createMenu(function(b){var c="redo";if(b(c)){var d=this,e=d.config.lang,f=new a.Menu({editor:d,id:c,title:e.redo});f.clickEvent=function(a){d.redo()},d.menus[c]=f,a.UI.menus[c]={normal:'<a href="#" tabindex="-1"><i class="icon icon-redo"></i></a>',selected:".selected"}}})})}(jQuery),function(a){var b=window.EDITOR;b.createMenu(function(a){var c="unorderlist";if(a(c)){var d=this,e=d.config.lang,f=new b.Menu({editor:d,id:c,title:e.unorderlist,commandName:"InsertUnorderedList"});d.menus[c]=f,b.UI.menus[c]={normal:'<a href="#" tabindex="-1"><i class="icon icon-list"></i></a>',selected:".selected"}}})}(jQuery);